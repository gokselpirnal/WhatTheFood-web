"use strict";angular.module("wtf",["ui.bootstrap","ui.router","ngNotify","angular-loading-bar","ngCookies","angularMoment"]).run(["$rootScope","$cookieStore","$location","$http","ngNotify",function(t,e,l,r,o){o.config({theme:"pure",position:"bottom",duration:1e3,type:"info",sticky:!1,html:!1});var a=window.location.host;t.serviceUrl="http://"+a+"/vtys_WhatTheFood/api",t.globals=e.get("globals")||{},t.globals.currentUser&&(r.defaults.headers.common.token=t.globals.currentUser.token),t.$on("$locationChangeStart",function(){"/register"!=l.path()||t.globals.currentUser?"/login"==l.path()||t.globals.currentUser||l.path("/login"):l.path("/register"),"/login"==l.path()&&t.globals.currentUser&&l.path("/")})}]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/"),t.state("index",{url:"/",views:{header:{templateUrl:"templates/header/header.html",controller:"HeaderCtrl"},footer:{templateUrl:"templates/footer/footer.html",controller:"FooterCtrl"},content:{templateUrl:"templates/home/home.html",controller:"HomeCtrl"}}}).state("about",{url:"/about",views:{header:{templateUrl:"templates/header/header.html",controller:"HeaderCtrl"},footer:{templateUrl:"templates/footer/footer.html",controller:"FooterCtrl"},content:{templateUrl:"templates/about/about.html",controller:"AboutCtrl"}}}).state("profile",{url:"/profile",views:{header:{templateUrl:"templates/header/header.html",controller:"HeaderCtrl"},footer:{templateUrl:"templates/footer/footer.html",controller:"FooterCtrl"},content:{templateUrl:"templates/profile/profile.html",controller:"UserCtrl"}}}).state("food_detail",{url:"/food/:foodId",views:{header:{templateUrl:"templates/header/header.html",controller:"HeaderCtrl"},footer:{templateUrl:"templates/footer/footer.html",controller:"FooterCtrl"},content:{templateUrl:"templates/food/detail.html",controller:"FoodCtrl"}}}).state("login",{url:"/login",views:{full:{templateUrl:"templates/user/login.html",controller:"LoginCtrl"}}}).state("register",{url:"/register",views:{full:{templateUrl:"templates/user/register.html",controller:"RegisterCtrl"}}}).state("logout",{url:"/logout",views:{full:{templateUrl:"templates/user/login.html",controller:"LoginCtrl"}}})}]);
angular.module("wtf").controller("FoodCtrl",["$scope","FoodService","$state","$stateParams","$rootScope","$location","$cookies","$http",function(o,e,t,r,i,f,n,a){o.profile={},o.foods={},o.food={},o.page=0,o.getPage=function(t){o.page=t,e.profile(t,function(e){e.error||e.user_id&&(o.profile=e)})},o.detail=function(){e.detail(r.foodId,function(e){e.error||(o.food=e)})}}]);
angular.module("wtf").controller("FooterCtrl",["$scope","$cookies",function(e,o){e.title="WhatTheFood",e.user=o.getObject("globals").currentUser}]);
angular.module("wtf").controller("HeaderCtrl",["$scope","$cookies",function(e,o){e.title="WhatTheFood",e.user=o.getObject("globals").currentUser}]);
angular.module("wtf").controller("HomeCtrl",["$scope","HomeService","$rootScope","$location","$cookies","$http",function(o,t,e,s,l,c){o.latestFoods=[],o.latestFoods=function(){t.latestFoods(function(t){t.error||(o.latestFoods=t)})},o.latestFoods()}]);
angular.module("wtf").controller("LoginCtrl",["$scope","LoginService","$rootScope","$location","$cookies","$http",function(o,e,t,l,n,a){var r=window.location.hash;"#/logout"==r&&n.putObject("globals",{}),o.user={email:"",password:""},o.login=function(o){var r=o.email,s=o.password;e.login(r,s,function(o){o.error||(e.setCredentials(o),n.putObject("globals",t.globals),a.defaults.headers.common.token=t.globals.currentUser.token,l.path("/"))})}}]);
function MasterCtrl(o,t){var e=992,g="#/login"==window.location.hash||"#/register"==window.location.hash?!0:!1,n=Math.floor(6*Math.random());console.log(g),console.log(n),o.getWidth=function(){return window.innerWidth},o.$watch(o.getWidth,function(g,n){g>=e?angular.isDefined(t.get("toggle"))?o.toggle=t.get("toggle")?!0:!1:o.toggle=!0:o.toggle=!1}),o.toggleSidebar=function(){o.toggle=!o.toggle,t.put("toggle",o.toggle)},window.onresize=function(){o.$apply()}}angular.module("wtf").controller("MasterCtrl",["$scope","$cookies",MasterCtrl]);
angular.module("wtf").controller("RegisterCtrl",["$scope","RegisterService","$rootScope","$location","$cookies","$http",function(e,s,t,o,r,g){e.user={email:"",password:""},e.msg={show:!1},e.register=function(t){var o=t.email,r=t.password;s.register(o,r,function(s){s.error||(s.message?(e.msg.show=!0,e.msg.text=s.message,e.msg.textColor="text-danger"):s.id&&(e.msg.show=!0,e.msg.text="Kayıt başarılı.",e.msg.textColor="text-success"))})}}]);
angular.module("wtf").controller("SidebarCtrl",["$scope","$cookies",function(e,n){e.menus=[{name:"Yemek Ara",href:"#/search",icon:"fa-home"},{name:"Yemek Ekle",href:"#/new-food",icon:"fa-pencil"},{name:"Kullanıcı Yönetimi",href:"#/users",icon:"fa-users"},{name:"Kategori Yönetimi",href:"#/categories",icon:"fa-folder-open"}]}]);
angular.module("wtf").controller("UserCtrl",["$scope","UserService","$rootScope","$location","$cookies","$http",function(o,r,e,f,i,n){o.profile={},o.foods={},o.profile=function(){r.profile(function(r){r.error||r.user_id&&(o.profile=r)})},o.foods=function(){r.foods(function(r){r.error||(o.foods=r)})},o.profile(),o.foods()}]);
angular.module("wtf").factory("FoodService",["$http","$rootScope",function(t,n){var e={};return e.getPage=function(e,o){t({method:"GET",url:n.serviceUrl+"/food/all/"+e,data:null,headers:{"Content-Type":"application/json"}}).then(function(t){o(t.data)})},e.detail=function(e,o){t({method:"GET",url:n.serviceUrl+"/food/"+e,data:null,headers:{"Content-Type":"application/json"}}).then(function(t){o(t.data)})},e.create=function(e,o){t({method:"POST",url:n.serviceUrl+"/food",data:null,headers:{"Content-Type":"application/json"}}).then(function(t){o(t.data)})},e.update=function(e,o){t({method:"PUT",url:n.serviceUrl+"/food/"+e.food_id,data:null,headers:{"Content-Type":"application/json"}}).then(function(t){o(t.data)})},e.remove=function(e,o){t({method:"DELETE",url:n.serviceUrl+"/food/"+e,data:null,headers:{"Content-Type":"application/json"}}).then(function(t){o(t.data)})},e}]);
angular.module("wtf").factory("HomeService",["$http","$rootScope",function(t,o){var e={};return e.latestFoods=function(e){t({method:"GET",url:o.serviceUrl+"/food/all/0",data:null,headers:{"Content-Type":"application/json"}}).then(function(t){e(t.data)})},e}]);
angular.module("wtf").factory("LoginService",["$http","$rootScope",function(e,n){var t={};return t.login=function(t,o,a){var r={email:t,password:o};e({method:"POST",url:n.serviceUrl+"/login",data:r,headers:{"Content-Type":"application/json"}}).then(function(e){a(e.data)})},t.setCredentials=function(e){n.globals={currentUser:{_id:e.user_id,email:e.email,token:e.token.token}}},t}]);
angular.module("wtf").factory("RegisterService",["$http","$rootScope",function(e,t){var r={};return r.register=function(r,a,n){var o={email:r,password:a};e({method:"POST",url:t.serviceUrl+"/register",data:o,headers:{"Content-Type":"application/json"}}).then(function(e){n(e.data)})},r}]);
angular.module("wtf").factory("UserService",["$http","$rootScope",function(e,t){var n={};return n.profile=function(n){e({method:"GET",url:t.serviceUrl+"/user/"+t.globals.currentUser._id+"/profile",data:null,headers:{"Content-Type":"application/json"}}).then(function(e){n(e.data)})},n.foods=function(n){e({method:"GET",url:t.serviceUrl+"/user/"+t.globals.currentUser._id+"/foods/0",data:null,headers:{"Content-Type":"application/json"}}).then(function(e){n(e.data)})},n}]);